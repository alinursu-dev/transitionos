{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<h1 class="h2 mb-4">Dashboard</h1>

<div class="row g-3 mb-4">
  <div class="col-sm-6 col-lg-3">
    <div class="card h-100">
      <div class="card-body">
        <p class="text-muted small text-uppercase mb-1">Savings goal</p>
        <p class="mb-2 fs-4 fw-semibold">{{ "%.0f"|format(savings_current) }} / {{ "%.0f"|format(savings_target) }} <span class="text-muted small">EUR</span></p>
        <div class="progress" style="height: 8px;">
          <div class="progress-bar" role="progressbar" style="width: {% if savings_percent > 100 %}100{% else %}{{ savings_percent }}{% endif %}%;" aria-valuenow="{{ savings_percent }}" aria-valuemin="0" aria-valuemax="100"></div>
        </div>
        <p class="mt-1 small text-muted">{{ savings_percent }}%</p>
      </div>
    </div>
  </div>
  <div class="col-sm-6 col-lg-3">
    <div class="card h-100">
      <div class="card-body">
        <p class="text-muted small text-uppercase mb-1">Freelance income</p>
        <p class="mb-0 fs-4 fw-semibold">{{ "%.0f"|format(freelance_current) }} / {{ "%.0f"|format(freelance_target) }} <span class="text-muted small">EUR/mo</span></p>
      </div>
    </div>
  </div>
  <div class="col-sm-6 col-lg-3">
    <div class="card h-100">
      <div class="card-body">
        <p class="text-muted small text-uppercase mb-1">Days to move</p>
        <p class="mb-0 fs-4 fw-semibold">{{ days_left }} <span class="text-muted small">days</span></p>
      </div>
    </div>
  </div>
  <div class="col-sm-6 col-lg-3">
    <div class="card h-100">
      <div class="card-body">
        <p class="text-muted small text-uppercase mb-1">Runway</p>
        <p class="mb-0 fs-4 fw-semibold">{{ "%.1f"|format(runway_months) }} <span class="text-muted small">months</span></p>
      </div>
    </div>
  </div>
</div>

<div class="card">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h2 class="h5 mb-0">Recent expenses</h2>
    <a href="{{ url_for('expenses.list') }}" class="btn btn-sm btn-outline-secondary">View all</a>
  </div>
  <div class="card-body p-0">
    {% if recent_expenses %}
      <div class="table-responsive">
        <table class="table table-hover mb-0">
          <thead class="table-light">
            <tr>
              <th>Date</th>
              <th>Amount</th>
              <th>Category</th>
              <th>Vendor</th>
            </tr>
          </thead>
          <tbody>
            {% for exp in recent_expenses %}
            <tr>
              <td>{{ exp.date.strftime('%d %b %Y') }}</td>
              <td>{{ "%.2f"|format(exp.amount) }} {{ exp.currency }}</td>
              <td>{{ exp.category }}</td>
              <td>{{ exp.vendor or 'â€”' }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <p class="text-muted mb-0 p-3">No expenses yet. <a href="{{ url_for('expenses.list') }}">Add one</a>.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
